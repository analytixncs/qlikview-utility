<salesflash><variable><name>vSC_date_CalendarYearField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_CalendarYear&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_CalendarYear&#x27;, &#x27;Create_CalendarYear&#x27;))</expression><description>This variable will be used in the CalendarYear list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>f5015945-41bc-4bb3-8e6f-c64b67b0e3f6</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_FiscalYearField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_FiscalYear&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_FiscalYear&#x27;, &#x27;Create_FiscalYear&#x27;))</expression><description>This variable will be used in the Fiscal Year list box and will change the field based on the value in the vSC_DateType field&gt;Test</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>56f48412-2bff-42df-84fe-2f9987233c09</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_QuarterField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_QuarterCalendarText&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_QuarterCalendarText&#x27;, &#x27;Create_QuarterCalendarText&#x27;))</expression><description>This variable will be used in the Quarter list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>0a8a8e1e-b79f-4852-b46e-0cb2d2a98832</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_PeriodField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_PeriodOfYearNumber&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_PeriodOfYearNumber&#x27;, &#x27;Create_PeriodOfYearNumber&#x27;))</expression><description>This variable will be used in the Period list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>0d05e918-80dd-47a3-bfd8-3db64ad2ada8</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_MonthField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_Month&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_Month&#x27;, &#x27;Create_Month&#x27;))
</expression><description>This variable will be used in the Month list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>3fb9d2bb-fa49-4edf-a0d6-a14ca734e691</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_DayOfMonthField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_DayOfMonth&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_DayOfMonth&#x27;, &#x27;Create_DayOfMonth&#x27;))</expression><description>This variable will be used in the Day of Month list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>37ba9ea7-7603-4596-972f-0426e2513bbf</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_CalendarDateField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;InsertCalendarDate&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;PostingCalendarDate&#x27;, &#x27;CreateCalendarDate&#x27;))</expression><description>This variable will be used in the CalendarDate list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>658e8c8c-e1df-4baf-b6e0-ba7f40701593</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_WeekField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_WeekOfYear&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_WeekOfYear&#x27;, &#x27;Create_WeekOfYear&#x27;))</expression><description>This variable will be used in the Week list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>526e012b-78f6-4afc-9b46-1dc3465c0fe9</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_DayOfWeekField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_DayOfWeekText&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_DayOfWeekText&#x27;, &#x27;Create_DayOfWeekText&#x27;))</expression><description>This variable will be used in the Day of Week list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>6c46136e-dfc2-45ca-a9e7-04093cba705a</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_HolidayField</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_HolidayName&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_HolidayName&#x27;, &#x27;Create_HolidayName&#x27;))</expression><description>This variable will be used in the Holiday list box and will change the field based on the value in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>a889a453-ad7d-4b4c-9d57-d11fce317c1a</id><notes>Selection Criteria Tab</notes></variable><variable><name>vSC_date_FLAG_YTD</name><expression>=IF(vSC_DateType=&#x27;INSERT&#x27;, &#x27;Insert_FLAG_YTD&#x27; ,  
 IF(vSC_DateType=&#x27;POSTING&#x27;,  &#x27;Posting_FLAG_YTD&#x27;, &#x27;Create_FLAG_YTD&#x27;))
</expression><description>This variable will be used to allow users to set the YTD flag for the values in the vSC_DateType field</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>dce5a14f-86ae-418e-ad16-cb5e21c6bbef</id><notes>Selection Criteria Tab</notes></variable><variable><name>mod_CY</name><expression>$(=$(vFiscalOrCalendarYear)) = {$(=$(SelectYear))}</expression><description>Formula Modifier for Current Year based on the SelectYear variable and taking into account whether user has selected Fiscal Or Calendar Year
This variable will be used in the Formulas spreadsheet to modify existing formulas/expression.</description><application>SalesFlash</application><group>Formula Modifiers</group><id>088ac143-3427-4414-b731-64bee0035786</id><notes>Additional information if needed.</notes></variable><variable><name>mod_PY</name><expression>$(=$(vFiscalOrCalendarYear)) = {$(=$(SelectYear)-1)}</expression><description>Formula Modifier for Previous Year based on the SelectYear variable and taking into account whether user has selected Fiscal Or Calendar Year
This variable will be used in the Formulas spreadsheet to modify existing formulas/expression.</description><application>SalesFlash</application><group>Formula Modifiers</group><id>65bf7be7-d922-40a4-b844-b7e585f33d19</id><notes /></variable><variable><name>mod_YTD</name><expression>$(=Capitalize(&#x27;$(vSC_DateType)&#x27;) &amp; &#x27;_FLAG_YTD&#x27;)={TRUE}</expression><description>Formula Modifier for YTD flag.  Will only return transactions that have the YTD flag set to TRUE.  It will take into account the type of date being used by the user (Insert, Posting or Create)</description><application>SalesFlash</application><group>Formula Modifiers</group><id>85690ed2-769e-42af-bf48-943b2bb03ad8</id><notes /></variable><variable><name>mod_Prev_YTD</name><expression>$(=Capitalize(&#x27;$(vSC_DateType)&#x27;) &amp; &#x27;_FLAG_PreviousYTD&#x27;)={TRUE}</expression><description>Formula Modifier for the Previous YTD flag.  Will only return transactions that have the Previous YTD flag set to TRUE.  It will take into account the type of date being used by the user (Insert, Posting or Create)</description><application>SalesFlash</application><group>Formula Modifiers</group><id>16aa9e68-f399-4eab-85ba-28fd7fcd6b87</id><notes /></variable><variable><name>vinputAccrualStartDate</name><expression>=Date(CURRENT_PeriodStartDate)</expression><description>Defines the beginning date for the report</description><application>SalesFlash</application><group>Report-Variables</group><id>63d183e0-747c-4ba9-b369-9521d33b44fc</id><notes>Finance tab-&gt;Accrual/Deferral button</notes></variable><variable><name>vinputAccrualEndDate</name><expression>=Date(CURRENT_PeriodEndDate)</expression><description>Defines the ending date for the report</description><application>SalesFlash</application><group>Report-Variables</group><id>bf94ed29-e145-4f48-822a-41e8c5d93de4</id><notes>Finance tab-&gt;Accrual/Deferral button</notes></variable><variable><name>vandProd_ProductSet</name><expression>=&#x27;SUM({&lt;$(vAndProd_ProductSetAcctOrAdOrder)=&#x27; &amp; Concat(Distinct {$} &#x27;{&quot;=COUNT({&lt;ProductName={&#x27; &amp; chr(39) &amp; ProductName, chr(39) &amp; &#x27;}&gt;} AccountNumber_AdBase)&gt;0&quot;}*&#x27;)
  &amp; chr(39) &amp; &#x27;}&gt;} $(vAndProd_ProductSetAcctOrAdOrder))&gt;0&quot;}$(vAndProd_ProductClear)&gt;} $(NetRevenue))&#x27;</expression><description /><application>SalesFlash</application><group>Report-Variables</group><id>626f2280-5818-4950-b750-03a52eee21de</id><notes /></variable><variable><name>vAndProd_ShowExpression</name><expression>=IF(vAndProd_ShowExpression=1,0,1)</expression><description /><application>SalesFlash</application><group>Report-Variables</group><id>e2491e51-45e3-40ab-a921-0a8291a6b27f</id><notes /></variable><variable><name>vAndProd_ShowHelp</name><expression>=IF(vShowHelp=&#x27;ANDHelp&#x27;, &#x27;&#x27;, &#x27;ANDHelp&#x27;)</expression><description /><application>SalesFlash</application><group>Report-Variables</group><id>701fb27b-a1a6-4649-b8f1-d9b682cfd0e6</id><notes /></variable><variable><name>vAndProd_ProductSetAcctOrAdOrder</name><expression>AccountNumber_AdBase</expression><description /><application>SalesFlash</application><group>Report-Variables</group><id>efaaca2e-066e-4557-a598-91f63d7f0963</id><notes /></variable><variable><name>vAndProd_ProductClear</name><expression>=null()</expression><description /><application>SalesFlash</application><group>Report-Variables</group><id>7e2af2ca-9109-48d3-be19-42882acfa499</id><notes /></variable><variable><name>vChurnPrevYear</name><expression>IF(IsNull(AGGR(SUM({$&lt;$(=$(vFiscalOrCalendarYear))={$(=$(SelectYear)-1)}&gt;} $(NetRevenue)), AccountNumber_AdBase)),0,AGGR(SUM({$&lt;$(=$(vFiscalOrCalendarYear))={$(=$(SelectYear)-1)}&gt;} $(NetRevenue)), AccountNumber_AdBase))</expression><description>AGGR function that returns revenue for customers in Previous Year</description><application>SalesFlash</application><group>Report-Variables</group><id>5eb2236d-0beb-4597-a36e-8acb6fe3467e</id><notes>Advertising tab -&gt; Churn</notes></variable><variable><name>vChurnCurrYear</name><expression>IF(IsNull(AGGR(SUM({$&lt;$(=$(vFiscalOrCalendarYear))={$(SelectYear)}&gt;} $(NetRevenue)), AccountNumber_AdBase)),0,AGGR(SUM({$&lt;$(=$(vFiscalOrCalendarYear))={$(SelectYear)}&gt;} $(NetRevenue)), AccountNumber_AdBase))</expression><description>AGGR function that returns revenue for customers in Current Year</description><application>SalesFlash</application><group>Report-Variables</group><id>09c224a0-5414-43b0-9631-ff610a59c013</id><notes>Advertising tab -&gt; Churn</notes></variable><variable><name>vChurnType</name><expression>YOY</expression><description>If MONTH, then show Churn by Month chart; if YOY, show YOY Churn</description><application>SalesFlash</application><group>Report-Variables</group><id>08d95f0c-dccf-4dba-b5f7-4916d6e4b5ed</id><notes>Advertising tab -&gt; Churn</notes></variable><variable><name>vChurnDynCurrMonth</name><expression>IF(IsNull(AGGR(SUM({$&lt;$(=$(vChurnDynMonthField))={$(=NUM(Mid(&#x27;$(SelectMonthYear)&#x27;,5,2)))},$(=$(vFiscalOrCalendarYear))={$(=Mid(&#x27;$(SelectMonthYear)&#x27;,1,4))}&gt;} $(NetRevenue)), AccountNumber_AdBase)),
 0,
  AGGR(SUM({$&lt;$(=$(vChurnDynMonthField))={$(=NUM(Mid(&#x27;$(SelectMonthYear)&#x27;,5,2)))},$(=$(vFiscalOrCalendarYear))={$(=Mid(&#x27;$(SelectMonthYear)&#x27;,1,4))}&gt;} $(NetRevenue)), AccountNumber_AdBase))</expression><description>Used for Monthly Churn calculations (this is the current Month formula)</description><application>SalesFlash</application><group>Report-Variables</group><id>1654ecfe-02f5-452f-8287-d76b7056c4e7</id><notes /></variable><variable><name>vChurnDynPrevMonth</name><expression>IF(IsNull(AGGR(SUM({$&lt;$(=$(vChurnDynMonthField))={$(=NUM(Mid(&#x27;$(SelectMonthYearPrev)&#x27;,5,2)))},$(=$(vFiscalOrCalendarYear))={$(=Mid(&#x27;$(SelectMonthYearPrev)&#x27;,1,4))}&gt;} $(NetRevenue)), AccountNumber_AdBase)),
 0,
  AGGR(SUM({$&lt;$(=$(vChurnDynMonthField))={$(=NUM(Mid(&#x27;$(SelectMonthYearPrev)&#x27;,5,2)))},$(=$(vFiscalOrCalendarYear))={$(=Mid(&#x27;$(SelectMonthYearPrev)&#x27;,1,4))}&gt;} $(NetRevenue)), AccountNumber_AdBase))</expression><description>Used for Monthly Churn calculations (this is the previous Month formula)</description><application>SalesFlash</application><group>Report-Variables</group><id>1cb1828b-7d46-464b-885a-98eaa50fc5ce</id><notes>Advertising tab -&gt; Churn (Monthly Churn)</notes></variable><variable><name>vChurnDynMonthField</name><expression>Capitalize(&#x27;$(vSC_DateType)&#x27;) &amp; &#x27;_MonthOfYearNumber&#x27;</expression><description>Dynamic field for the Month field in the monthly churn chart</description><application>SalesFlash</application><group>Report-Variables</group><id>e39415b2-80f1-40f2-b25b-ff35b9b08032</id><notes>Advertising tab -&gt; Churn (Monthly Churn)</notes></variable><variable><name>vShowTotals</name><expression>0</expression><description>Flag to be used when using code to show and hide totals in a pivot table.  In base version this is only in the Preprint report on the Advertising tab as an example.</description><application>SalesFlash</application><group>Report-Variables</group><id>24bdba51-6391-4cff-a593-6710686005cc</id><notes /></variable><variable><name>vsysCurrentSelections</name><expression>=if(vsysShowCS = 1, &#x27;  Click Here To Hide&#x27;, if(isnull(GetCurrentSelections()), &#x27;  Nothing selected&#x27;, GetCurrentSelections(&#x27; | &#x27;, &#x27;: &#x27;, &#x27;,&#x27;,0)))</expression><description>Used in the DisplayCurrent Selections boxes.</description><application>SalesFlash</application><group>System-CurrentSelections</group><id>867eca34-b727-4bb0-8b59-e72ca547d6b2</id><notes /></variable><variable><name>vsysShowCS</name><expression>0</expression><description>Flag to determine if we should show or hide a current selections object</description><application>SalesFlash</application><group>System-CurrentSelections</group><id>d3567178-bbf6-470b-9f0a-59e5d832bd03</id><notes /></variable><variable><name>vsysFormulaCreatorTemp</name><expression>…</expression><description>A variable that will hold the formula being created by Formula Creator.</description><application>SalesFlash</application><group>System-FormulaCreator</group><id>e29d8cd6-389e-40df-93ee-e1ddca674131</id><notes /></variable><variable><name>vLoadOldAcctNums</name><expression>0</expression><description>Flag to determine if we should load old accountnumbers</description><application>SalesFlash</application><group>System-Load Switches</group><id>919a0712-788c-4366-a7da-4885416d2451</id><notes>Main tab</notes></variable><variable><name>vReloadVariables</name><expression>0</expression><description>Used in SOURCE_ to determine if this spreadsheet should be reloaded.  Turned on and off in the application NOT here.</description><application>SalesFlash</application><group>System-Load Switches</group><id>4947d880-0036-462f-b46f-b27852a66876</id><notes>Main tab</notes></variable><variable><name>vLoadCRM</name><expression>0</expression><description>Used in SOURCE_ to determine if CRM data will be loaded.  Turned on and off in the application NOT here.</description><application>SalesFlash</application><group>System-Load Switches</group><id>64d05d10-391d-43f1-a440-606fb283a32a</id><notes>Main tab</notes></variable><variable><name>vLoadPRPSchedule</name><expression>0</expression><description>Used in SOURCE_ to determine if Preprint schedule information from Core will be loaded.  Turned on and off in the application NOT here.</description><application>SalesFlash</application><group>System-Load Switches</group><id>9d05b749-5087-4b26-8e78-62f4db8d1460</id><notes>Main tab</notes></variable><variable><name>vLoadBudget</name><expression>0</expression><description>Used in SOURCE_ to determine if Budget spreadsheet information will be loaded.  Turned on and off in the application NOT here.</description><application>SalesFlash</application><group>System-Load Switches</group><id>c05c5c6d-c985-44c9-aada-35f94e795672</id><notes>Main tab</notes></variable><variable><name>vLoadCustomScripts</name><expression>0</expression><description>Used in SOURCE_ to determine if Custom Scripts should be loaded.  If true, Source file will look in CustomScripts\SalesFlash\*.qvs</description><application>SalesFlash</application><group>System-Load Switches</group><id>d03b453e-fab0-4034-8906-900f5ddf91de</id><notes>Main tab</notes></variable><variable><name>vExcludeGLs</name><expression>0</expression><description>Used in SOURCE_ to determine if ExcludeGLs information should be read and processed from the SystemSheet.xls -&gt; GLExcludeList</description><application>SalesFlash</application><group>System-Load Switches</group><id>701c9762-f6d2-4113-b880-5c64a15bcc8b</id><notes>Main tab</notes></variable><variable><name>vLoadAdvRevenue</name><expression>0</expression><description>Used in SOURCE_ to determine if we are to load revenue from the fctInsertSummary and Detail tables. Can increase load times significantly</description><application>SalesFlash</application><group>System-Load Switches</group><id>9bea5583-fe19-4e1b-a2d5-fc57f16b12f3</id><notes>Main tab</notes></variable><variable><name>vShowHelp</name><expression> </expression><description>Used to show and hide help text boxes.</description><application>SalesFlash</application><group>System-Variables</group><id>ba373daa-2ce4-4d2f-9bfb-c5a8924bb855</id><notes /></variable><variable><name>vsysButtonColorOn</name><expression>ARGB(100,209,239,180)</expression><description>On sheets with a button bar down the side, this will be the color of the button selected.</description><application>SalesFlash</application><group>System-Variables</group><id>9063f24d-dffb-455a-a173-ab87ae6e3711</id><notes /></variable><variable><name>vsysButtonColorOff</name><expression>ARGB(255,255,255,255)</expression><description>On sheets with a button bar down the side, this will be the color of the buttons NOT selected.</description><application>SalesFlash</application><group>System-Variables</group><id>238c88b9-8d77-4a44-9bae-c2f9c305c462</id><notes /></variable><variable><name>vLastActivityDate</name><expression>DATE(AGGR(MAX({1} InsertCalendarDate),AccountNumber_AdBase))</expression><description>Return the most recent (could even be in the future depending on expression) insertion date for every customer.  
This expression will return the last insert date for customers and could be in the future:
=DATE(AGGR(MAX({1} InsertCalendarDate),AccountNumber_AdBase))
You can also limit the dates that the expression looks for the last insertion.  The expression below will search for the last insert date before one month ago Today.
=DATE(AGGR(MAX({1} InsertCalendarDate),AccountNumber_AdBase))</description><application>SalesFlash</application><group>System-Variables</group><id>41eae623-6b37-4d4a-8931-de4ad45d3408</id><notes>Advertising tab -&gt; Inactive customers</notes></variable><variable><name>vOSUser</name><expression>=OSUser()</expression><description>User logged into the application.</description><application>SalesFlash</application><group>System-Variables</group><id>c5a85e70-f9d5-4e42-9bca-eeb6e2b1d345</id><notes /></variable><variable><name>SelectYear</name><expression>=[YearComparison%]</expression><description>Used for Year over Year caclulations</description><application>SalesFlash</application><group>System-Variables</group><id>55ca408f-b9c5-4c53-9541-d1c97bcb2443</id><notes /></variable><variable><name>vFiscalOrCalendarYear</name><expression>Capitalize(&#x27;$(vSC_DateType)&#x27;) &amp; &#x27;_CalendarYear&#x27;</expression><description>Allows the user to do YOY comparisons based on the Fiscal or Calendar Year.  Will be either Posting_CalendarYear or Insert_CalendarYear.
Sample Dimension Usage:
=$(=$(vFiscalOrCalendarYear))
Sample Expression Usage:
SUM( {&lt;$(=$(vFiscalOrCalendarYear)) = {$(=$(SelectYear))}&gt;} $(NetRevenue))</description><application>SalesFlash</application><group>System-Variables</group><id>a97e8234-440c-48f1-b063-c66e1b1d0d9d</id><notes /></variable><variable><name>vFiscalOrCalendarYearLabel</name><expression>Calendar</expression><description>Label for the List boxes, Dimensions and Expressions that use the Dynamic Year and month/period fields</description><application>SalesFlash</application><group>System-Variables</group><id>eeb86a2e-8209-4886-972d-5f55cc780b7e</id><notes /></variable><variable><name>vFiscalOrCalendarMonthPeriod</name><expression>Capitalize(&#x27;$(vSC_DateType)&#x27;) &amp; &#x27;_Month&#x27;</expression><description>Dynamic field that can be used in Dimensions.  This will allow the user to select whether they see Insert/posting/create and Calendar(month) or Fiscal(period).
=$(=$(vFiscalOrCalendarMonthPeriod))</description><application>SalesFlash</application><group>System-Variables</group><id>295054e4-daa5-4209-bef1-02171fc24ca0</id><notes /></variable><variable><name>vFiscalOrCalendarMonthPeriodLabel</name><expression>Month</expression><description>Label to be used for the charts that use this Dynamic Dimension</description><application>SalesFlash</application><group>System-Variables</group><id>900dcfad-f26f-4630-9aa4-821030631a23</id><notes /></variable><variable><name>vFiscalOrCalendarPrevYTD</name><expression /><description>Sets the YTD Flag based on the Date settings - Controlled by YTDSwitch Macro
Capitalize(&#x27;$(vSC_DateType)&#x27;) &amp; &#x27;_FLAG_PreviousYTD&#x27;</description><application>SalesFlash</application><group>System-Variables</group><id>35b4a7f3-4543-4a95-8cbc-0118138a1ca8</id><notes /></variable><variable><name>vFiscalOrCalendarYTD</name><expression /><description>Sets the YTD Flag based on the Date settings - Controlled by YTDSwitch Macro
Capitalize(&#x27;$(vSC_DateType)&#x27;) &amp; &#x27;_FLAG_YTD&#x27;</description><application>SalesFlash</application><group>System-Variables</group><id>169a7803-6e5a-4ac3-af92-581595843037</id><notes /></variable><variable><name>vsysShowAdvancedSheets</name><expression>0</expression><description>When true, shows the Formulas, Formula Creator and Tables and Fields sheets.</description><application>SalesFlash</application><group>System-Variables</group><id>153b8eda-4604-40ec-96a2-6114223e5c8f</id><notes /></variable><variable><name>vbtnsFinance</name><expression>1</expression><description>Controls which reports are showing on the Finance sheet</description><application>SalesFlash</application><group>Button Lists</group><id>53bb2a93-1014-4b29-aa28-af3e30e676b7</id><notes>Finance Tab</notes></variable><variable><name>vbtnsAdvertising</name><expression>1</expression><description>Controls which reports are showing on the Advertising sheet</description><application>SalesFlash</application><group>Button Lists</group><id>65b9aec3-444a-42bd-a37e-01505ae48ba1</id><notes>Advertising Tab</notes></variable><variable><name>vbtnsReference</name><expression>1</expression><description>Controls which reports are showing on the Reference sheet</description><application>SalesFlash</application><group>Button Lists</group><id>aa1859bb-1a95-48f7-a139-6cdbd5d2ec15</id><notes>Reference Tab</notes></variable><variable><name>vbtnsCRM</name><expression>1</expression><description>Controls which reports are showing on the CRM sheet</description><application>SalesFlash</application><group>Button Lists</group><id>43333765-2995-4bab-b680-db5636799863</id><notes>CRM Tab</notes></variable><variable><name>vTab</name><expression>DateActive</expression><description>Used on Selection Criteria tab to determine which side tab is active.  
OPTIONS: DateActive, ProductActive, SalesActive or OtherActive</description><application>SalesFlash</application><group>Button Lists</group><id>862bb193-cfb7-43c8-938d-14e08cf35dd7</id><notes>Selection Criteria tab</notes></variable><variable><name>vQSTab</name><expression>DateActive</expression><description>Used on all reporting tabs to determine which Quick Selection Ribbon tab is active. 
OPTIONS: DateActive, ProductActive, SalesActive, GLActive or OtherActive</description><application>SalesFlash</application><group>Button Lists</group><id>ccd32048-499d-4abe-b7bd-76fe62eae427</id><notes>Quick Select ribbon</notes></variable><variable><name>vSC_DateType</name><expression>POSTING</expression><description>Holds either INSERT, POSTING or CREATE.  Used to dynamically change Date List boxes. </description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>9526c2d0-48ba-4d25-a869-bbb4e7a7b786</id><notes>Selection Criteria Tab</notes></variable><variable><name>vFiscalOrCalendarFlag</name><expression>0</expression><description>0=Calendar, 1=Fiscal</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>9d2b10d1-8c58-4b0e-818a-2659a1466623</id><notes /></variable><variable><name>vGL_BUCKET_1</name><expression>vGL_BUCKET_1</expression><description>The Expression here will be the new field name for use in SalesFlash.qvw</description><application>SalesFlash</application><group>GL Buckets</group><id>9be99c9f-89ac-45cb-8eae-158cd7bb57d4</id><notes /></variable><variable><name>vGL_BUCKET_2</name><expression>vGL_BUCKET_2</expression><description>The Expression here will be the new field name for use in SalesFlash.qvw</description><application>SalesFlash</application><group>GL Buckets</group><id>6b19c3d2-ae26-420b-9865-a8d5478f2f6e</id><notes /></variable><variable><name>vGL_BUCKET_3</name><expression>vGL_BUCKET_3</expression><description>The Expression here will be the new field name for use in SalesFlash.qvw - You do NOT need to fill in all of these</description><application>SalesFlash</application><group>GL Buckets</group><id>833763cf-2b5c-4b54-b21c-1fbd446db600</id><notes /></variable><variable><name>vGL_BUCKET_4</name><expression>vGL_BUCKET_4</expression><description>The Expression here will be the new field name for use in SalesFlash.qvw - You do NOT need to fill in all of these</description><application>SalesFlash</application><group>GL Buckets</group><id>c622ac1d-9815-47d1-845f-88e6ba1f4164</id><notes /></variable><variable><name>vGL_BUCKET_5</name><expression>vGL_BUCKET_5</expression><description>The Expression here will be the new field name for use in SalesFlash.qvw - You do NOT need to fill in all of these</description><application>SalesFlash</application><group>GL Buckets</group><id>0f7375b8-29eb-4802-9ebf-e20ec22100df</id><notes /></variable><variable><name>vGL_BUCKET_6</name><expression>vGL_BUCKET_6</expression><description>The Expression here will be the new field name for use in SalesFlash.qvw - You do NOT need to fill in all of these</description><application>SalesFlash</application><group>GL Buckets</group><id>8c55082d-c184-4b22-8ceb-aef217482029</id><notes /></variable><variable><name>vinputTopNNN</name><expression>25</expression><description>User entered, number of top/bottom performers to show.</description><application>SalesFlash</application><group>InputBox</group><id>716df822-17df-426e-b435-e900f33b9598</id><notes>Advertising tab -&gt; Winners/Losers button</notes></variable><variable><name>vInactiveDays</name><expression>30</expression><description>Used along with the vLastActivityDate to determine if a customer should be returned on the &quot;inactive customer&quot; report.  This will be the initial number of Inactive Days shown.</description><application>SalesFlash</application><group>InputBox</group><id>6ef6bd9b-38eb-482f-a58a-fd2dca2dc731</id><notes>Advertising tab -&gt; Inactive customers</notes></variable><variable><name>vsheet_Finance</name><expression>1</expression><description>1 = Show Sheet; 0 = Hide Sheet</description><application>SalesFlash</application><group>Sheet Visability</group><id>f8bb7628-0f66-4f90-bae8-bd80eebc5572</id><notes /></variable><variable><name>vsheet_Advertising</name><expression>1</expression><description>1 = Show Sheet; 0 = Hide Sheet</description><application>SalesFlash</application><group>Sheet Visability</group><id>208f314e-5e0c-40b8-a567-72cb3e4ed430</id><notes /></variable><variable><name>vsheet_RevCompare</name><expression>1</expression><description>1 = Show Sheet; 0 = Hide Sheet</description><application>SalesFlash</application><group>Sheet Visability</group><id>8889d252-2188-404e-91ab-4e6bef62ee82</id><notes /></variable><variable><name>vsheet_Budget</name><expression>1</expression><description>1 = Show Sheet; 0 = Hide Sheet</description><application>SalesFlash</application><group>Sheet Visability</group><id>09d69eac-ce9a-451c-a92b-0453417d7ff8</id><notes /></variable><variable><name>vShowAdvancedSheets</name><expression>0</expression><description>Shows/hides Reference Charts, Tables &amp; Fields, Formulas, Formula Creator tabs</description><application>SalesFlash</application><group>Sheet Visability</group><id>9235564e-787d-4d9c-8414-7c48421da28e</id><notes>Main tab</notes></variable><variable><name>vDaysInPreviousYear</name><expression>Date((Today())-(MakeDate(Year(Today())-1,12,31)-MakeDate(Year(Today())-1,1)))</expression><description>Returns the number of days in the CurrentYear -1 (Previous Year)</description><application>SalesFlash</application><group>Report-Variables</group><id>3c468576-a386-4e2c-bb6d-e9187cdabcd4</id><notes /></variable><variable><name>vGaugeFillToSegment1</name><expression>RGB(110,175,75)</expression><description>First segment of Gauge from Zero to Lower bound of Segment2.</description><application>SalesFlash</application><group>System-Colors</group><id>66896e41-7410-4c30-9c96-ab677cd9bf9c</id><notes>Gauges</notes></variable><variable><name>vGaugeFillToSegment2</name><expression>RGB(191,191,191)</expression><description>Second segment of Gauge from Lower bound of Segment2 to end.</description><application>SalesFlash</application><group>System-Colors</group><id>49ebd06b-c1ec-40a4-9599-bb201eedba6d</id><notes>Gauges</notes></variable><variable><name>vGaugeFillToOverSegment</name><expression>RGB(80,130,50)</expression><description>This is the color of the whole gauge if the expression exceeds the bounds.  If gauge is from 0 to 100 and we have 142, this color would show.</description><application>SalesFlash</application><group>System-Colors</group><id>403989d8-2be5-4140-9e27-089257037d5f</id><notes>Gauges</notes></variable><variable><name>vGaugeSegmentOrange</name><expression>RGB(220,140,35)</expression><description>Segment will be Orange</description><application>SalesFlash</application><group>System-Colors</group><id>411f125e-27ec-4298-bd68-2c3c2d4adf81</id><notes /></variable><variable><name>vGaugeSegmentRed</name><expression>RGB(180,75,75)</expression><description>Gauge segment Red</description><application>SalesFlash</application><group>System-Colors</group><id>b7092f50-fc97-44bb-b989-a142f89d8939</id><notes /></variable><variable><name>vGaugeSegmentGreen</name><expression>RGB(110,175,75)</expression><description>Gauge segment will be green</description><application>SalesFlash</application><group>System-Colors</group><id>c9b4b0cc-1148-4011-80e0-190634f1a59f</id><notes /></variable><variable><name>vRevBand1</name><expression>0</expression><description>Revenue Band 1</description><application>SalesFlash</application><group>RevBands</group><id>15359f71-f105-484c-a436-f48a190d2ced</id><notes /></variable><variable><name>vRevBand2</name><expression>2500</expression><description>Revenue Band 2</description><application>SalesFlash</application><group>RevBands</group><id>318bc5d0-8909-49e1-af71-587b9d6fa702</id><notes /></variable><variable><name>vRevBand3</name><expression>5000</expression><description>Revenue Band 3</description><application>SalesFlash</application><group>RevBands</group><id>7d539dc7-29b3-4c90-9d1d-3b656b31b94d</id><notes /></variable><variable><name>vRevBand4</name><expression>10000</expression><description>Revenue Band 4</description><application>SalesFlash</application><group>RevBands</group><id>831048a2-839a-41a6-9b7b-c4ff6190579b</id><notes /></variable><variable><name>vRevBand5</name><expression>20000</expression><description>Revenue Band 5</description><application>SalesFlash</application><group>RevBands</group><id>3c077d1e-236e-4100-b078-ef939c6af69d</id><notes /></variable><variable><name>vRevBand6</name><expression>40000</expression><description>Revenue Band 6</description><application>SalesFlash</application><group>RevBands</group><id>b5d1d579-c015-43b0-a976-99d4fdaa67f3</id><notes /></variable><variable><name>vRevBand7</name><expression>100000</expression><description>Revenue Band 7</description><application>SalesFlash</application><group>RevBands</group><id>6b700246-8fa8-4778-a2e0-7e50a8346b23</id><notes /></variable><variable><name>vRevBand1Label</name><expression>=NUM(vRevBand1, &#x27;&gt;= #,##0;(#,##0)&#x27;) &amp; IF(Len(vRevBand2)&gt;0,  &#x27; &lt; &#x27; &amp;  NUM(vRevBand2, &#x27;#,##0;(#,##0)&#x27;))</expression><description>Label for Revenue Band 1</description><application>SalesFlash</application><group>RevBands</group><id>15359f71-f105-484c-a436-f48a190d2</id><notes /></variable><variable><name>vRevBand2Label</name><expression>=NUM(vRevBand2, &#x27;&gt;= #,##0;(#,##0)&#x27;) &amp; IF(Len(vRevBand3)&gt;0,  &#x27; &lt; &#x27; &amp;  NUM(vRevBand3, &#x27;#,##0;(#,##0)&#x27;))</expression><description>Label for Revenue Band 2</description><application>SalesFlash</application><group>RevBands</group><id>318bc5d0-8909-49e1-af71-587b9d6fa</id><notes /></variable><variable><name>vRevBand3Label</name><expression>=NUM(vRevBand3, &#x27;&gt;= #,##0;(#,##0)&#x27;) &amp; IF(Len(vRevBand4)&gt;0,  &#x27; &lt; &#x27; &amp;  NUM(vRevBand4, &#x27;#,##0;(#,##0)&#x27;))</expression><description>Label for Revenue Band 3</description><application>SalesFlash</application><group>RevBands</group><id>7d539dc7-29b3-4c90-9d1d-3b656b31b</id><notes /></variable><variable><name>vRevBand4Label</name><expression>=NUM(vRevBand4, &#x27;&gt;= #,##0;(#,##0)&#x27;) &amp; IF(Len(vRevBand5)&gt;0,  &#x27; &lt; &#x27; &amp;  NUM(vRevBand5, &#x27;#,##0;(#,##0)&#x27;))</expression><description>Label for Revenue Band 4</description><application>SalesFlash</application><group>RevBands</group><id>831048a2-839a-41a6-9b7b-c4ff61905</id><notes /></variable><variable><name>vRevBand5Label</name><expression>=NUM(vRevBand5, &#x27;&gt;= #,##0;(#,##0)&#x27;) &amp; IF(Len(vRevBand6)&gt;0,  &#x27; &lt; &#x27; &amp;  NUM(vRevBand6, &#x27;#,##0;(#,##0)&#x27;))</expression><description>Label for Revenue Band 5</description><application>SalesFlash</application><group>RevBands</group><id>3c077d1e-236e-4100-b078-ef939c6af</id><notes /></variable><variable><name>vRevBand6Label</name><expression>=NUM(vRevBand6, &#x27;&gt;= #,##0;(#,##0)&#x27;) &amp; IF(Len(vRevBand7)&gt;0,  &#x27; &lt; &#x27; &amp;  NUM(vRevBand7, &#x27;#,##0;(#,##0)&#x27;))</expression><description>Label for Revenue Band 6</description><application>SalesFlash</application><group>RevBands</group><id>b5d1d579-c015-43b0-a976-99d4fdaa3</id><notes /></variable><variable><name>vRevBand7Label</name><expression>=NUM($(vRevBand7), &#x27;&gt;= #,##0;(#,##0)&#x27;) </expression><description>Label for Revenue Band 7</description><application>SalesFlash</application><group>RevBands</group><id>6b700246-8fa8-4778-a2e0-7e50a8b23</id><notes /></variable><variable><name>vRevBand0Label</name><expression>=&#x27;&lt; &#x27; &amp; NUM($(vRevBand1), &#x27;#,##0;(#,##0)&#x27;) </expression><description>Label for Revenue Band 0</description><application>SalesFlash</application><group>RevBands</group><id>3fee414b-4403-419d-a95d-c2df079e04a3</id><notes /></variable><variable><name>vBandList</name><expression>=IF (len(vRevBand1)&gt;0, chr(39) &amp; &#x27;vRevBand1&#x27; &amp; chr(39))  &amp;
IF (len(vRevBand2)&gt;0, &#x27;,&#x27; &amp; chr(39) &amp; &#x27;vRevBand2&#x27; &amp; chr(39)) &amp;
IF (len(vRevBand3)&gt;0, &#x27;,&#x27; &amp; chr(39) &amp; &#x27;vRevBand3&#x27; &amp; chr(39)) &amp;
IF (len(vRevBand4)&gt;0, &#x27;,&#x27; &amp; chr(39) &amp; &#x27;vRevBand4&#x27; &amp; chr(39)) &amp;
IF (len(vRevBand5)&gt;0, &#x27;,&#x27; &amp; chr(39) &amp; &#x27;vRevBand5&#x27; &amp; chr(39)) &amp;
IF (len(vRevBand6)&gt;0, &#x27;,&#x27; &amp; chr(39) &amp; &#x27;vRevBand6&#x27; &amp; chr(39)) &amp;
IF (len(vRevBand7)&gt;0, &#x27;,&#x27; &amp; chr(39) &amp; &#x27;vRevBand7&#x27; &amp; chr(39))</expression><description>Dynamic List of Revenue Bands used</description><application>SalesFlash</application><group>RevBands</group><id>8cc937e0-7fc9-4b40-b87d-a5e383fce643</id><notes>Used so user doesn&#x27;t need to enter all bands.  This will create a list of used bands.</notes></variable><variable><name>vBandDim</name><expression>=concat( &#x27;IF(AGGR($(_NetRevenue_CY), AccountNumber_AdBase)&lt;$&#x27; &amp; chr(40) &amp;
    ValueList($(vBandList))
    &amp; chr(41) &amp; &#x27;, dual(vRevBand&#x27; &amp; (Right(ValueList($(vBandList)), 1)-1) &amp; &#x27;Label, &#x27; &amp; (Right(ValueList($(vBandList)), 1)-1) &amp; chr(41), 
    &#x27;,&#x27;
    ) &amp; &#x27;, dual(vRevBand&#x27; &amp; (substringcount( vBandList , &#x27;,&#x27;) + 1) &amp; &#x27;Label, &#x27; &amp; (substringcount( vBandList , &#x27;,&#x27;) + 1) &amp; &#x27;)&#x27; &amp;
    Repeat(chr(41), substringcount( vBandList , &#x27;,&#x27;) +1)</expression><description>expression that builds the dimension for the revenue bands</description><application>SalesFlash</application><group>RevBands</group><id>1d8623fa-2f97-47f0-8280-a8ee2917bef0</id><notes /></variable><variable><name>vFiscalOrCalendarMonthPeriodNum</name><expression>Capitalize(&#x27;$(vSC_DateType)&#x27;) &amp; &#x27;_MonthOfYearNumber&#x27;</expression><description>Dynamci field that can be used in dimensions. This will select either Insert/Posting/Create MonthOfYearNumber or PeriodOfYearNumber</description><application>SalesFlash</application><group>System-Variables</group><id>c94a9a6c-8cd6-4cfa-9fbc-29e0a4f19468</id><notes /></variable><variable><name>vdynYTD_MonthPeriodFinalCalc</name><expression>IF(vFiscalOrCalendarFlag, 
$(vdynYTD_getGreatestMonthPeriod)
, Num(Month(Date#($(vdynYTD_getGreatestMonth), &#x27;MMM&#x27;)))
)</expression><description>Final caclulation for the dynamic YTD expression.  It will return either the greatest ..._Month selected as a number or the greatest ..._PeriodOfYearNumber based on the vFiscalOrCalendarFlag setting.</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>a5ba810b-eaf9-480c-9d36-3d2f54baa9e6</id><notes /></variable><variable><name>vdynYTD_getGreatestMonthPeriod</name><expression>Mid(GetFieldSelections($(=$(vFiscalOrCalendarMonthPeriod)), &#x27;;&#x27;,13), 
	Index(GetFieldSelections($(=$(vFiscalOrCalendarMonthPeriod)),&#x27;;&#x27;,13),&#x27;;&#x27;, -1)+1)</expression><description>For use in the vdynYTD_MonthPeriodFinalCalc variable expression.  It will return either the greatest Month from ..._Month or Period from ..._PeriodOfYearNumber</description><application>SalesFlash</application><group>Dynamic Date Selection</group><id>4c35dd3e-52bd-4cf3-b65e-52bee8c3171f</id><notes /></variable><variable><name>vLoadAgingData</name><expression>0</expression><description>Option to load Aging Data</description><application>SalesFlash</application><group>System-Load Switches</group><id>a791d0e6-3dd5-411a-945b-c4e3cbd7204f</id><notes>Will load data from the core database tables AgingCustomer, AgingDetail and AgingOptions</notes></variable><variable><name>btnPleaseDeleteMe</name><expression>SUM(${&lt;insert_date={$(=today())}&gt;} Amount}</expression><description>This is a test</description><application>SalesFlash</application><group>Button Lists</group><id>cfd8e43e-17e9-4a0d-b105-e165a7bab115</id><notes>Testing Notes</notes></variable></salesflash>